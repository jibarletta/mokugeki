import pandas as pd
from wordcloud import WordCloud
import matplotlib.pyplot as plt
import datetime
import nltk
from nltk.corpus import stopwords
from pathlib import Path
import os
import shutil

# Primero cargamos las stop words a ser utilizadas en cada una de las funciones presentes.
nltk.download("stopwords")
stopwords = set(stopwords.words("spanish"))
stopwords.update(["que", "de", "el", "por", "se", "est√°", "lo", "en", "si", "https", "preview", "redd", "it", "qu",
                  "giphy", "gif", "jpeg", "webp", "www", "png", "format", "com", "width"])

# Definimos la funci√≥n que vamos a utilizar para el armado de la wordcloud.
def nube_palabras(archivo):
    """Toma el post y crea la nube de palabras."""
    file = pd.read_csv(f"{Path.cwd()}/Bases/{archivo}", index_col=0)
    data = ','.join(file["comentario"])
    data = data.lower()
    wordcloud = WordCloud(stopwords=stopwords).generate(data)
    wordcloud.to_file(f"Bases/{archivo}.png")
    plt.figure(figsize=(15, 10))
    plt.imshow(wordcloud, interpolation="bilinear")
    plt.axis("off")
    plt.show()


# Definimos la funci√≥n para obtener una tabla de frecuencias de palabras.
def freq_palabras(archivo):
    """Toma el post y crea la tabla de frecuencias de palabras."""
    # Primero cargamos las stop words a ser utilizadas en cada una de las funciones presentes.
    # nltk.download("stopwords")
    # stopwords = set(stopwords.words("spanish"))
    # stopwords.update(["que", "de", "el", "por", "se", "est√°", "lo", "en", "si", "https", "preview", "redd", "it", "qu",
    #                   "giphy", "gif", "jpeg", "webp", "www", "png", "format", "com", "width"])
    file = pd.read_csv(f"{Path.cwd()}/Bases/{archivo}", index_col=0)
    tabla_dict = {"palabra": [], "frecuencia": []}
    data = ','.join(file["comentario"])
    data.lower()
    conteo = WordCloud(stopwords=stopwords).process_text(data)
    for word in conteo:
        tabla_dict["palabra"].append(word)
        tabla_dict["frecuencia"].append(conteo[word])
    tabla = pd.DataFrame(tabla_dict)
    tabla = tabla.sort_values(by="frecuencia", ascending=False)
    tabla.to_csv(f"{Path.cwd()}/Bases/{archivo}-TC.csv")
    return tabla    # Este return se agreg√≥ para las pruebas. Revisar.

# TODO: Proba armar el diccionario antes, hacerlo un DF y luego concatenarlo.

# Defino la funci√≥n para agregar al dataset los temas del d√≠a.
def ds_add_temas(diccionario):
    post_dict = {"id": [],
                 "context": [],
                 "text": [],
                 "upv": [],
                 "author": [],
                 "date": [],
                 "type": [],
                 }
    # dataset_dict = {"id": [],
    #                 "context": [],
    #                 "text": [],
    #                 "upv": [],
    #                 "author": [],
    #                 "date": [],
    #                 "type": [],
    #                 }
    # # file = pd.read_csv(f"{Path.cwd()}/Bases/Temas/{temas}", index_col=0)
    # df_temp = pd.read_csv(f"{Path.cwd()}/Bases/Temas/{temas}", index_col=0)
    # df_temas = df_temp[1:6]
    # df_temas.set_index('id')
    for row in diccionario:
        post_dict['id'].append(row['id'])
        post_dict['context'].append(row['id'])
        post_dict['text'].append(row['titulo'])
        post_dict['upv'].append(row['upvotes'])
        post_dict['author'].append(row['autor'])
        fecha_post = row['creado'].split(' ')
        fecha_post = fecha_post[0]
        post_dict['date'].append(fecha_post)
        post_dict['type'].append('post')
    # shutil.move(f"{Path.cwd()}/Bases/Temas/{temas}", f"{Path.cwd()}/Bases/Procesados/Temas")
    ds_temas = pd.DataFrame(post_dict)
    dataset = pd.read_csv(f"{Path.cwd()}/Bases/Red_Arg_Dataset.csv", index_col=0)
    nuevods = pd.concat([dataset, ds_temas], sort=False)
    nuevods.to_csv(f"{Path.cwd()}/Bases/Red_Arg_Dataset.csv")

# Defino la funci√≥n para agregar los comentarios al data set.
def ds_add_coms(diccionario):
    filename_date = dt.now().strftime('%Y-%m-%d')  # -%H-%M removido del filename
    # comment_dict = {"id": [],
    #                 "comentario": [],
    #                 "upvotes": [],
    #                 "parent": [],
    #                 "autor": []
    #                 }
    comm_dict = {"id": [],
                     "context": [],
                     "text": [],
                     "upv": [],
                     "author": [],
                     "date": [],
                     "type": [],
                     }
    for row in diccionario:
        comm_dict['id'].append(row['id'])
        p_split = row['parent'].split('_')
        idctx = p_split[1]
        comm_dict['context'].append(idctx)
        comm_dict['text'].append(row['comentario'])
        comm_dict['upv'].append(row['upvotes'])
        comm_dict['author'].append(row['autor'])
        comm_dict['date'].append(filename_date)
        comm_dict['type'].append('comment')
    nuevocomds = pd.DataFrame(comment_dict)
    dataset = pd.read_csv(f"{Path.cwd()}/Bases/Red_Arg_Dataset.csv", index_col=0)
    nuevocmds = pd.concat([dataset, nuevocomds])
    nuevocmds.to_csv(f"{Path.cwd()}/Bases/Red_Arg_Dataset.csv")

# TODO: Borrar el c√≥digo inferior, qued√≥ para pruebas.
# archivo = "Red_Arg_Comm_Post-1dji1nx--2024-06-19-19-11.csv"
#
# nube_palabras(archivo)
# print(freq_palabras(archivo))

# temas = 'Reddit_Arg_Temas-2024-07-21.csv'
# comentarios = 'Red_Arg_Comm_Post-1e8jkcj--2024-07-21.csv'

# temas_dict_prueba = {'titulo': ['Nos silbaron el himno en Francia‚Ä¶', 'Misiones: Joven quiso grabar una toma del rally y le sali√≥ mal', 'Hace 2 d√≠as Milei se puso hablar por Twitter. Le pidieron que arregle lo de los 12k usd al a√±o y hoy lo cambi√≥', "A los marroquies que la vivieron bardeando en la cancha y silbando nuestro himno, se cre√≠an que ganaban y el seleccionado de Mascherano les empat√≥ en los √∫ltimos segundos de tiempo agregado. 15:25' gol.", 'Parque Chas: La emoci√≥n de un pibe que se compr√≥ su primera Play 5', 'Posteo Messi despu√©s del partido argentina y Marruecos', 'Fallecio uno de mis gatitos.', 'Voy a comer con 3800 $ hasta el viernes y te lo muestro. D√≠a 1, hay fotito', 'Noticiero Chileno sobre los argentinos: ‚Äú¬øSe creen italianos? Entiendo a un alem√°n racista, ¬øpero a un argentino racista? Con el color de su piel no los dejar√≠an ni entrar a Francia‚Äù.', 'Preguntas y respuestas'], 'upvotes': [455, 447, 391, 353, 322, 312, 283, 287, 250, 248], 'id': ['1eb1jcq', '1eb2kmj', '1eamhwp', '1eb3xmx', '1easkmo', '1eb76te', '1eal51e', '1eaos8e', '1eajh16', '1eb4m32'], 'comentarios': [170, 71, 162, 199, 48, 96, 66, 139, 209, 209], 'creado': [datetime.datetime(2024, 7, 24, 10, 30, 34), datetime.datetime(2024, 7, 24, 11, 16, 21), datetime.datetime(2024, 7, 23, 20, 28, 32), datetime.datetime(2024, 7, 24, 12, 13, 9), datetime.datetime(2024, 7, 24, 1, 30, 54), datetime.datetime(2024, 7, 24, 14, 25, 27), datetime.datetime(2024, 7, 23, 19, 30, 5), datetime.datetime(2024, 7, 23, 22, 14, 18), datetime.datetime(2024, 7, 23, 18, 20, 46), datetime.datetime(2024, 7, 24, 12, 40, 52)], 'autor': [Redditor(name='youneverknowho'), Redditor(name='RealRock_n_Rolla'), Redditor(name='chimenea'), Redditor(name='RavingAnarchy'), Redditor(name='RealRock_n_Rolla'), Redditor(name='Striking-Smile5727'), Redditor(name='Revolutionary_End666'), Redditor(name='MamasSolasHazClick'), Redditor(name='youneverknowho'), Redditor(name='youneverknowho')]}
# comm_dict_prueba = {'id': ['lephmu3', 'leper69', 'lepo65s', 'lepfzjx', 'lepknv7', 'lepx9pt', 'lepzkxb', 'lepjj09', 'lephusr', 'lepgxyx', 'lepo9hb', 'lepi6i7', 'leq0fgp', 'lepqvt9', 'lepyaen', 'leq11l0', 'leq4gp2', 'leq45u6', 'leqlits', 'lepoecr', 'leq2vax', 'leprfes', 'lepu20l', 'lepprk0', 'leq11gh', 'lepsrik', 'lepu939', 'lepq2zg', 'lepwnq9', 'leqmv8v', 'leqpjc0', 'leqq8pb', 'ler09e1', 'lerdi33', 'lepqj7j', 'lepsud4', 'lepni7w', 'lepuxz8', 'lepw5b9', 'leps1le', 'lepw568', 'lepufyx', 'leq48q7', 'leqcfjf', 'leqha3s', 'leqnije', 'leqnngt', 'leqqk70', 'leqqkqe', 'leqsixv', 'leqy6ev', 'ler3b3w', 'lerd4gx', 'lere3cf', 'lerigg7', 'lerja75', 'lerkdsl', 'lermaa2', 'leropbs', 'lerq53i', 'lepwjqy', 'leq5dzl', 'leps0ss', 'leprhha', 'lepwws8', 'leqrshm', 'lepv0dm', 'leq2utg', 'lepv33m', 'leq9ua9', 'lerksju', 'lepufdg', 'lepqv88', 'leq6dfa', 'leqfu3u', 'leq2urv', 'lercj24', 'lephjkt', 'lepj6gw', 'lepxtzr', 'leprb3v', 'leqkhxe', 'leptcc2', 'lepmysa', 'lepupys', 'lepliwo', 'leqa9ei', 'lepma0p', 'lepwoqt', 'lepjkfi', 'leq365w', 'leq13rt', 'lepryqp', 'leq0mdo', 'lepx6op', 'leq5buf', 'leq8lt7', 'lepwmus', 'lepy2xj', 'lepziao', 'lepyq4a', 'leputd6', 'lepvwuk', 'lept3cp', 'lepk0xp', 'lepus0t', 'lepqhbq', 'leq4h85', 'leq4dne', 'leq4o3i', 'lequy2i', 'lepzux4', 'leprev1', 'lepz7z9', 'leq4zg9', 'lepw3i7', 'leprm0t', 'leqw4q6', 'lepjwhw', 'lerj612', 'leqkdaz', 'leq57ud', 'leq0iyw', 'lepzbum', 'leqfgm3', 'leqnsi6', 'leqa45u', 'leq0uw9', 'ler3hrd', 'leqnzae', 'lepwqw8', 'lepwl5v', 'leq0s5p', 'lepn1ci', 'leq7w3x', 'leqj9m4', 'leqys6n', 'leqg1m5', 'ler5zyx', 'leq1a9t', 'leq6pdo', 'lepzzcb', 'leq08ow', 'leret6f', 'leqt8j6', 'ler3tpr', 'lerjagy', 'lerfsxq', 'lershp3', 'leqkrs2', 'leqvnfx', 'leq8nus', 'ler50gp', 'lepx094', 'lepwz8s', 'ler9iq3', 'leq2ry5', 'ler3zgz', 'lerrnv5', 'lepxfo1', 'lerk7oh', 'lerfoj3', 'leq1huu', 'lepxp1y', 'lerl2g8', 'lerrrhi', 'leq4ql9', 'leqd9bx', 'leqe5gw'], 'comentario': ['Son todos marroquies igual. El estadio esta todo rojo. Encima son re gedes.', 'La pr√≥xima se puede poner la marcha de San Lorenzo, a ver si les trae recuerdos.', 'soy yo o suena rar√≠sima la musica?', 'Que culo roto que hay que hacer para silbar en un himno boludo... Se inventaron un enemigo imaginario y ahora se la creen tanto que hacen este tipo de pelotudeces', 'Pero si eran todos Marroqu√≠es...', 'https://preview.redd.it/jyh367g4hhed1.png?width=720&format=png&auto=webp&s=3cc2a673c99b533739646dfd5dce9aa5e61bf769', '![gif](giphy|d4pbwnf8B6e1G)', 'Mejor, significa que todavia les duele la cola', 'Q raro el masche ya esta perdiendo', 'y si estamos jugando contra los locales', 'https://preview.redd.it/mcrr1y9f8hed1.png?width=416&format=png&auto=webp&s=d4c0efa5e9ee92c103e3d1c4afceae1c140525c4', 'Ni idea, capaz enh la cultura allahu akbar es un signo de respeto?', 'Ya lo dijo la gran Thalia:\n\n‚ô™ *La envidia les corroe, mi vida les agobia* ‚ô´', 'Que versi√≥n rara del himno', 'Excelente que pongan el himno COMPLETO', 'Ya empez√≥??? No comienza ma√±ana?', 'Empate con los marronies', 'como puede ser que haya un pais mas gede que nosotros????????? Maldito marruecos? Veo un enemigo frente a mi, a inventar una cancion muchachos', 'De eso no habla la Fifa? no se expresan pos del chelsea o el culo roto de mbappe? \n\nHdps estos sinicos europeos', 'Est√°n ardidos, Yo no les dar√≠a bolas a los franceses que inventaron el perfume para no ba√±arse, o que sus comidas cl√°sicas son ratatouille (verduritas para pobres), Pich√≥n (paloma), Escargots (caracoles de tierra), y su selecci√≥n nacional est√° llena de vendedores calejeros de lentes. no estoy discriminado, estoy describiendo....', 'Son unos cabezas de mierda. Te chiflan sin parar todo el primer tiempo, te cantan todo el segundo. Meten bengalas y petardos de contrabando para festejar/hacer disturbios. Se meten en la cancha a apurar cuando pierden...\n\n\nYo los quiero, qu√© quer√©s que te diga, a todos le hacen lo mismo. No fue exclusivamente contra nosotros.', 'Hay que silbarles el himno de Angola entonces, ah no par√°', '¬øQu√© se hacen los ofendidos los mugrientos franchutes? son colonialistas, son chorros, igual que los de inglaperra.', '¬øeso es de ahora?', 'Grit√© el segundo gol como si fuese el mundial. Que detestables son los marroqu√≠es', 'estan convencidos q son la raza superior. no pueden entender que un pais sudaca les rompio el culo.   \nel pais mas racista de mundo entero nos llama racistas a nosotros. les exploto el cerebro, estan con el culo al norte.', 'Hermoso.. la siguen teniendo adentro.. eso me hace muy feliz', 'https://preview.redd.it/5sozgds8ahed1.jpeg?width=990&format=pjpg&auto=webp&s=09a7edcfd88608b39d7e40aa5d56cc9763aad012', 'Que despu√©s no lloren; qu√© se banquen la vuelta.', 'Lo primero que falta de respeto y 2 Francia ![img](emote|t5_2qlht|2153)', 'Que la sigan chupando, franceses culo rotos, se arrodillaron y se traicionaron entre ellos para hacerle una felacion al bigote gracioso en el 40, de esa no se vuelve.', 'C√≥mo van a silbar el himno jajaja menos deporte los africanos estos inventen una canci√≥n para bardearnos o algo p√≥ngale voluntad por lo menos', 'En Espa√±a estos subdesarrolados de mierda estan haciendo desastre. \n\nhttps://www.eldebate.com/espana/cataluna/20240121/multiculturalismo-hunde-barcelona-casi-80-delitos-fueron-cometidos-poblacion-extranjera_168590.html', 'Francia es un pa√≠s deshecho que camina hacia el desastre.', 'Qu√© esperaban de Francia...jajaja putos gabachos', 'Ah, mira vos...\n\nEscuchen', 'Que pod√©s esperar de los angole√±os esos, digo franceses...', 'Pasa que se olvidaron de llevar el manzan', 'Que pasar√≠a si se juega un Argentina - Francia en estos juegos? ü§£ü§£ü§£ü§£ü§£ü§£ü§£', 'moros de mierda, son asi, con Ejpania hacen lo mismo', 'normal, la mitad de francia son negros, marroquies, musulamaneses, etc.', 'mal por parte de los franceses sin duda, lamentablemente no sorprende, pero nosotros no somos carmelitas descalzas tampoco, mas alla de cantitos pelotudos por parte de futbolistas mas pelotudos', 'Como dir√≠a el Diegote, que la sigan chupando.', 'A la hora de cantar el himno arrancamos con el ESCUCHEN', 'Che, que hace Otamendi ah√≠ üòÇ, no era sub-23?', 'Bueno, nuevo rival para toda la vida adquirido. A matar en la cancha si nos volvemos a cruzar', '![gif](giphy|d4pbwnf8B6e1G|downsized)', 'Son turistas marroqu√≠es que vacacionan en Francia y fueron para las olimpiadas\n\n![gif](giphy|3o6Zt4HU9uwXmXSAuI)', 'y bueno que la ves hacer', 'Y si. Marruecos juega de local en Francia', 'Cantaron todo a destiempo. Era para silvarles‚Ä¶  üòÇ', 'Empujen la esfera...', 'que bueno que me avisaste, hoy duermo desnudo asi me pueden chupar un huevo mientras estoy durmiendo.', 'Zurdo hijo de...\n\nhttps://preview.redd.it/ubzk6j6duied1.png?width=720&format=pjpg&auto=webp&s=e3b2ba6df13c44dc48f2b9641195e0ac9e0b807f', 'q quer√©s, que te lo aplaudan?!?!? lo mismo hubiese pasado ac√° con Francia', 'Y si.... una manga de resentidos....', 'Nos? Si yo no estuve en Francia', 'Lo mejor que tenemos como argentinos es que cuando nos joden de esta manera, nuestro ego sube porque sabemos que les estamos rompiendo tanto el orto como para que tengan que hacer esto.  \nUna maravilla que a√∫n siendo insultados y faltados de respeto, tengamos el ego y la confianza tan alto.', 'Son silbidos o vuvuzelas? üá¶üá¥üá®üá≤', 'Y lo m√°s ir√≥nico es que fueron africanos, no europeos.\n\n(Menos mal que el p√∫blico iba a ser neutral)', 'Y s√≠', 'Pero el boludito de Enzo Fern√°ndez canta una canci√≥n racista contra los franceses y despu√©s ustedes no se la bancan (?)', 'Hicieron bien', 'Es entendible, la ultima vez que un himno argentino se toco en Paris Adolfo se estaba paseando con los tanques.', 'Si ellos hubieran ganado en Qatar y el partido fuera ac√°. ¬øAplaudir√≠an su himno? ¬øQu√© se hacen los ofendidos ahora? Si no fuera por los partidos de Argentina, ni siquiera se acordar√≠an que tenemos un himno Termos.', 'Ac√° hay muchas pretensiones, pero no hay que olvidar que Argentina siempre ha sido dise√±ada para ser una copia barata de Francia y lo sigue siendo, un poco de respeto amigos', 'Menos mal que nos la bancamos una bandaaaa', 'Con la cantidad de marroqu√≠es que viven en Europa son casi locales.', 'Por como est√° la situaci√≥n en Francia y Espa√±a, me animar√≠a a decir que los marroqu√≠es son la mayor√≠a de sus poblaciones.', 'this. Son salvajes, y lo mejor es que el quilombo lo tiene Francia por m√©rito propio de ser tan cucks. Nuestros deportistas en unos d√≠as se van y todos esos quedan en Francia.', 'Si sudamericanos, sobre todo un argentinos, hubiesen silbado un himno Europeo ya estar√≠an pidiendo sanci√≥n a la FIFA, al El Comit√© Ol√≠mpico Internacional, exigiendo las disculpas del embajador y haciendo una campa√±a en las redes con figuras de todos lados criticando el hecho aberrante.', 'Pero eso era contra los espa√±oles...', 'Si no esta saturado como el parlante del colegio suena mal.', 'Nop, es cualquiera esta versi√≥n. Si no estoy prestando atenci√≥n ni cuenta me doy que es el himno de Argentina. No s√© de d√≥nde la sacaron pero espero que se extinga.', 'Una poronga la m√∫sica, parece un MIDI y al 150% de velocidad.', 'Me parece que est√° acelerado el tempo', 'Te das cuenta que ni lo pueden cantar los jugadores, solo hasta el final es que lo llegan a entender', 'Tal cual. Cada vez que leo, veo o escucho cosas de este tipo (Argenfifa, que compramos partidos como si nos sobrara la guita y despu√©s terminan en un ox√≠moron dici√©ndonos "Hambrientina") no me imagino otra cosa que un berrinche infantil. De ni√±os que no pueden admitir una derrota, que alguien jug√≥ mejor que ellos y buscan una excusa fantasiosa para justificar la victoria del otro. Ni√±os rata, al fin y al cabo.', 'Si pero no. Era imposible q no pase y para El resto del mundo nosotros nos inventamos un enemigo imagination cuando estos celebraron la Copa America con "la cancion". Ahora vamos a tener rivalidad y mala dangre por las proximas dos decadas.', 'era obvio que iba a pasar. convengamos que los jugadores cantando la cancion de francia despues de ganar la copa america tambien fue bastante random.\n\nigual me divierte la rivalidad, nos motiva.', 'Se lo inventaron ellos el enemigo imaginario o nosotros cant√°ndoles hasta en torneos que no juegan y cuando no son ni un cl√°sico?', 'Lo peor es que justifican una actitud de mierda como represalia a una supuesta actitud de mierda.\n\nO sea si algo es despreciable ok, te lo tomo, pero no por eso vas a hacer otra cosa despreciable...', 'Si en Sudam√©rica siempre se silban los himnos jajaja lo √∫nico que muestra esto es que los franceses siempre fueron igual de caca. Que ya lo sabiamos igual, as√≠ que siga el baile.', 'Que falta de introspecci√≥n. Ellos son los que tienen el enemigo imaginario? O somos nosotros los que cantamos canciones tirandoles dardos a√∫n cuando ganamos un campeonato en otro continente?', 'chabon el enemigo lo inventamos nosotros dejate de joder. boqueamos y despues lloramos.', 'Posta,la peor hinchada de cualquier selecci√≥n,en el mundial fueron una mierda todo el torneo', 'En el partido de los pumas tambi√©n pas√≥', 'ESO ES POR PONER DE TECNICO A UN AMIGO Y NO AL MAS CAPACITADO', 'No les metas el dedo en la herida!!!\n\nRe ardidos.', 'Nada muestra respeto por nada entre los takbir takbir, desde hace mil a√±os solo saben romper.', 'El futbol se juega antes de la ceremonia de apertura. No trates de entenderlo, disfrutalo.', 'Al final: que auto te compraste?\nMe acuerdo de tu post preguntando por el fluence, pero no lo segu√≠ y me qued√© con las ganas de saber si lo compraste.', 'Juego s ol√≠mpicos. 2024', 'Corran la bola', 'Si ellos hubieran ganado en Qatar y el partido fuera ac√°. ¬øLos argentinos aplaudir√≠an su himno? ¬øQu√© se hacen los ofendidos ahora? Yo soy argentino y me ASCO que sean tan hip√≥critas e imb√©ciles. Si no fuera por los partidos de futbol, ni siquiera se acordar√≠an que tenemos un himno.', 'qqqqqqqqq', 'Jajajaja cualquier cosa dijiste.', 'Juegan en espa√±a pero son marroquies', 'Fu√≠ hace un tiempo a Espa√±a...es una invasi√≥n. Vi m√°s musulmanes y marroquies que espa√±oles', '[deleted]', 'Cierto pais en los 30-40 la utilizo para sus marchas y francia andaba en modo pasiva con ellos', 'Veo que la historia no es su fuerte caballero.', 'por momentos es como que el tiempo y las notas.... no se, cero oido musical,pero me son√≥ raro', 'Grondona es Vice de la FIFA por 146 a√±os, Argentina no gana ni al metegol: I Sleep\n\nArgentina presenta la mejor selecci√≥n de su √©poca reciente con recambio joven y estrategia en una de sus peores recesiones economicas: ARGENFIFA???', 'Ni√±o rata? Eso ofende viejo\n\nhttps://preview.redd.it/glchl3464hed1.png?width=829&format=png&auto=webp&s=472353f06ef1ddd6eaf08fa4403017ec55f38ba5', 'Compramos el mundial con sueldos de 500 d√≥lares, no conquistamos el mundo porque no queremos jajajajajaja', 'No empez√≥ con la canci√≥n flaco, mbappe ya tiraba mierda para estos lares 3 meses antes del mundial.', 'En un micro se cantan un mont√≥n de cosas. No es lo mismo que cantarlas en la cancha.', 'En la cancha no se les cant√≥ nada.', 'El argentino nunca tiene la culpa.', 'En cancha local nunca se les cant√≥ nada y el quilombo lo empezo ª Mbapp√© hablando pestes. \n\nPara hacerle juego a los franceses andate al sub de ellos', '>  O somos nosotros los que cantamos canciones tirandoles dardos a√∫n cuando ganamos un campeonato en otro continente?\n\nEl chiste empez√≥ porque Mbapp√© dijo que Europa tiene mejor futbol que Sudam√©rica, entonces sali√≥ la cancioncita mof√°ndose de qu√© tan Europa era Europa (mas all√° de que Mbapp√© y compa√±√≠a son nacidos en Francia). Y ahora que Francia fue eliminada en la Euro y nosotros volvimos a ganar, se dio la oportunidad de volver a frotar sal en la herida.', 'Que la sigan chupando', 'Que memoria de pez, el bardo con Francia vino porque Mbapp√© boqueaba antes del mundial. De ah√≠ todas las cargadas', 'Jaja durante el quilombo de Enzo todos llamando llorones e hip√≥critas a los franceses. Nos silban el himno y nos ofendemos.\n\n\nAc√° son todos bravos cuando les conviene nomas', 'Boludo son la hinchada de Laferrere a nivel internacional. Mi lado termo de hincha argentino los banca mientras se enfrenten a los europeos, pero tenerlos en contra es una mierda', 'Esto es argentina y el chiqui mafia manda.', 'ESO ES POR PONER DE TECNICO A UN ~~AMIGO~~ PELADO', 'que te pasa con el skibidi toilet', 'No tengo auto ni quiero tener ja', 'Ni estaba enterado,...se nota que ya no importan a naides.', 'juegan en marruecos pero son todos re goma', 'Sos muy cortina hermano, de onda', 'Totalmente, si fuera al rev√©s seguramente se quemar√≠a la bandera de Francia.', 'Jajaja googlea la marcha de San Lorenzo. Me lo downvotean porque son peronistas seguro.', 'Corran la bola corran la bola...', 'imaginate los antepasados de los espa√±oles, siglos luchando contra la ocupaci√≥n de los moros y ahora estos les abren la puerta as√≠ nom√°s. No pueden m√°s de cucks.', 'Es algo que hermosamente est√° desapareciendo en Italia. Tengo mi casa familiar en N√°poles y un piso en Mil√°n, y debo decir que baj√≥ much√≠simo el n√∫mero de allahu akbars que se ven por la calle (deportados a la mierda) tanto en el sur como en el norte.\n\nEl √∫nico lugar que sigue comprometido es Roma, pero tambi√©n not√© que no andan tan pesados los de las pulseritas en el centro.', 'Bue, todo espa√±a est√° plagado de construcciones musulmanas; los tuvieron ocupados como 700 a√±os. Prescripci√≥n adquisitiva y coso.', 'Tu comentario est√° basado ~~en emociones y no datos.~~', 'No entendi yo tampoco', 'Pero si literalmente habla de la batalla de san lorenzo contra el imperio espa√±ol', 'El ritmo esta todo cambiado, la verdad no se si sera por reglamento o algo asi pero debe ser para que todos los himnos duren mas o menos lo mismo y se canten la misma cantidad de estrofas, no se .-.', 'Eat my shorts.', 'Nunca olvidar la cerrada de orto a Mbapp√© justo despu√©s que se fue de boca. Qu√© √©pico, por Dios.', 'Le dedicaron el mundial a 2018 a Leo tambi√©n, Se inventaron un enemigo, y nosotros respondimos gustosamente.', 'Te acord√°s? Cuando bardeo a toda america latina.\n\n\nBueno pero hay racismo y *racismo*', 'la cantaron los gallinas el otro dia', 'Hermano, no nos pongamos a defender lo indefendible. Que Enzo, siendo jugador de la selecci√≥n haya cantado esa canci√≥n ofensiva de un grupito de amigos, en un stream en vivo, es un error que trae este tipo de consecuencias, por m√°s que todo esto sea una boludez. Justamente lo gracioso de esa canci√≥n era lo exageradamente ofensiva para un enfrentamiento como contra el de Francia, con el que no existe esa clase de rivalidad.', 'Est√° bien, lo entiendo, pero hay que reconocer que eso fue culo roto de nuestra parte.', 'No boqueaba nada Mbappe. Dio su opini√≥n (err√≥nea) sin intenci√≥n de provocar y nosotros como siempre exageramos, lo tomamos de punto y lo recontra boludeamos despu√©s de ganar la final, le inventamos una canci√≥n re zarpada y se la volvemos a cantar 2 a√±os despu√©s luego de ganar otra copa en otro continente que nada que ver con Francia. El enemigo no lo inventaron ellos ni a palos jajaja', '> Boludo son la hinchada de Laferrere a nivel internacional\n\nPoes√≠a pura', 'Gan√≥ un mundial, es m√°s intocable que el l√≠der del cartel de Sinaloa.', 'skibidi', 'Hinchan para Marruecos pero son todos unos gomas\nYa van a ver van a correr\nVan a correr como corri√≥ en Isly\nMohamed \nY van a ver y van a ver\nSe creen pa√≠s pero de ac√° se siente\nDe ac√° se siente la baranda\nDe colonia de una baguette', 'Pero no tiene nada que ver el himno con eso', 'no entiendo, que tiene que ver adolfo con la marcha de san lorenzo', 'No pod√©s decir eso flaco... primero tienen que ESCUCHAR', 'Corran el bal√≥n?', 'posta, gallegos, franchutes y brits eran los mas poronga de europa...ahora son los mas cucks de todos', 'Literal no dur√≥ como 800 a√±os la reconquista? jajaja tremendo tiro en el pie.', 'En Italia pusieron bien el voto.', 'dooooondee?', 'https://tn.com.ar/internacional/2021/06/13/por-que-el-ejercito-de-hitler-toco-la-marcha-de-san-lorenzo-cuando-alemania-ocupo-francia/', 'https://tn.com.ar/internacional/2021/06/13/por-que-el-ejercito-de-hitler-toco-la-marcha-de-san-lorenzo-cuando-alemania-ocupo-francia/', 'Ojo, en ning√∫n momento dije que est√° bien o que era el proceder correcto. Simplemente estoy detallando la cadena de acontecimientos.', 'El tono del cantito estuvo mal, pero el hecho de gastar no. Si a los franceses no les gust√≥, hubieran ganado el mundial ü§∑', 'Pero reite de un chiste amigo', '[https://tn.com.ar/internacional/2021/06/13/por-que-el-ejercito-de-hitler-toco-la-marcha-de-san-lorenzo-cuando-alemania-ocupo-francia/](https://tn.com.ar/internacional/2021/06/13/por-que-el-ejercito-de-hitler-toco-la-marcha-de-san-lorenzo-cuando-alemania-ocupo-francia/)', 'alguna fuente q no sea eso,algun libro de historia o algo\\_ por q ni el video tiene audio o como saber si tocaron esa marcha', 'Para m√≠ si. Ya les ganamos la final del mundial. Con eso basta, qu√© necesidad hay de seguir bardeandolos? En especial en un torneo que no ten√≠a nada que ver.', 'pero que tenga gracia primero', 'Una publicaci√≥n del instituto Sanmartiniano te alcanza? \n\n[Link](https://web.archive.org/web/20110706083905/http://www.sanmartiniano.gov.ar/textos/parte2/texto042.php)\n\n[Otra fuente](https://web.archive.org/web/20120425161404/http://www.abcc.org.ar/health-issues---our-hospital/la-marcha-de-san-lorenzo)', 'Es un hecho hist√≥rico reconocido, yo te tiro la punta vos hace tu investigaci√≥n.', 'Y... son cosas del futbol. El "Brasil decime qu√© se siente" lo exprimimos por como 7 a√±os. En mi humilde opini√≥n hay cantitos contra Francia por lo menos hasta Junio del 2026.', 'Les hace falta historia', 'Muy flojo todo el mundo, siempre pens√© que era muy conocida la an√©cdota.', 'Ni sabia,pero el objetivo de la cancion de la marcha de san lorenzo es otro,no era contra los franceses,ni ellos se deben acordar de eso', 'Me parece que lo est√°n diciendo en chiste.'], 'upvotes': [255, 151, 42, 289, 72, 30, 30, 64, 33, 39, 33, 53, 8, 12, 5, 7, 4, 4, 5, 15, 6, 7, 8, 3, 4, 7, 7, 6, 5, 2, 2, 2, 2, 2, 4, 4, 3, 2, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, -4, -5, -5, -1, 58, 52, 62, 10, 1, 10, 45, 6, 6, 6, 1, 126, 29, 9, 9, 3, 9, 3, -10, 38, 2, 21, 11, 18, 7, 6, 5, 7, -1, 1, 2, 59, 43, -14, 30, 22, 7, 68, 38, 18, 35, 4, 7, 3, 3, 15, 9, 16, 0, 26, 12, 2, 16, 1, 1, 6, 2, 1, -2, 3, 36, 44, 1, 1, 2, 0, 9, 9, 11, 8, 5, 1, 3, 4, -6, 12, 7, 1, 1, 2, 1, 2, 1, 10, 4, 23, 1, 20, 13, 1, 10, 1, 1, -6, 1, 1, 12, 12, 1, 1, 6, 1, 3], 'parent': ['t3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't3_1eb1jcq', 't1_lephmu3', 't1_lephmu3', 't1_lephmu3', 't1_lephmu3', 't1_lephmu3', 't1_leper69', 't1_lepo65s', 't1_lepo65s', 't1_lepo65s', 't1_lepo65s', 't1_lepo65s', 't1_lepfzjx', 't1_lepfzjx', 't1_lepfzjx', 't1_lepfzjx', 't1_lepfzjx', 't1_lepfzjx', 't1_lepfzjx', 't1_lepfzjx', 't1_lepknv7', 't1_lepknv7', 't1_lephusr', 't1_lepgxyx', 't1_lepi6i7', 't1_leq11l0', 't1_lepu20l', 't1_lepprk0', 't1_lepsud4', 't1_leps0ss', 't1_leprhha', 't1_lepwws8', 't1_lepv33m', 't1_lepv33m', 't1_lepv33m', 't1_lepufdg', 't1_lepufdg', 't1_lepqv88', 't1_lephjkt', 't1_lephjkt', 't1_lephjkt', 't1_lepj6gw', 't1_lepxtzr', 't1_leprb3v', 't1_leprb3v', 't1_leprb3v', 't1_lepmysa', 't1_lepmysa', 't1_lepupys', 't1_lepupys', 't1_lepliwo', 't1_lepma0p', 't1_lepma0p', 't1_lepjkfi', 't1_leq13rt', 't1_lepryqp', 't1_leq0mdo', 't1_lepx6op', 't1_lepx6op', 't1_leq5buf', 't1_lepwmus', 't1_lepy2xj', 't1_lepy2xj', 't1_lepy2xj', 't1_lepziao', 't1_leputd6', 't1_leputd6', 't1_lepvwuk', 't1_lepk0xp', 't1_lepqhbq', 't1_lepqhbq', 't1_lepqhbq', 't1_leq4h85', 't1_lepzux4', 't1_lepzux4', 't1_lepz7z9', 't1_lepw3i7', 't1_leprm0t', 't1_lepjwhw', 't1_leq57ud', 't1_leqfgm3', 't1_leqfgm3', 't1_leqnsi6', 't1_leqnsi6', 't1_leqa45u', 't1_leqa45u', 't1_leq0uw9', 't1_leq0uw9', 't1_lepwqw8', 't1_lepwl5v', 't1_ler5zyx', 't1_leq1a9t', 't1_ler3tpr', 't1_lerjagy', 't1_lepwz8s', 't1_leq2ry5', 't1_ler3zgz', 't1_lepxfo1', 't1_lepxfo1', 't1_lerk7oh', 't1_lerfoj3', 't1_lepxp1y', 't1_leq4ql9', 't1_leqd9bx'], 'autor': [Redditor(name='Own_Aardvark8373'), Redditor(name='CruzandoElRubicon'), Redditor(name='_oxitono'), Redditor(name='Maxproo5'), Redditor(name='Own-Economy-2256'), Redditor(name='Zaap125'), Redditor(name='RuboPosto'), Redditor(name='Revolutionary_Heart6'), Redditor(name='nico_fug5'), Redditor(name='bautim'), Redditor(name='Carpincho_matero'), Redditor(name='Afraid_Night9947'), Redditor(name='VRichardsen'), Redditor(name='Captain_Rupert'), Redditor(name='NarcissisticNarcosis'), Redditor(name='Axelaux'), Redditor(name='IsawYourship'), Redditor(name='ZiYu14'), Redditor(name='Mage_Ozz'), Redditor(name='Juicio_Sumario'), Redditor(name='GilPsterCareta'), Redditor(name='ray_velcoro78'), Redditor(name='Ok_Half7136'), Redditor(name='Tricky_Pianist1469'), Redditor(name='The-Casanova'), Redditor(name='manucanay'), Redditor(name='gaschindler'), Redditor(name='Tricky_Pianist1469'), Redditor(name='CarlosMartel10'), Redditor(name='Lolita_dominatrix'), Redditor(name='SkimmingDeath8298'), Redditor(name='Capuneitor'), Redditor(name='cederian'), Redditor(name='Nexus888888'), Redditor(name='Rowelt85'), Redditor(name='HolaKafka'), Redditor(name='Emotional-Handle-269'), Redditor(name='Brolenus'), Redditor(name='heenaasaaa'), Redditor(name='suncontrolspecies'), Redditor(name='No_Fan7109'), Redditor(name='marcianolopez'), Redditor(name='Jauretche'), Redditor(name='patoezequiel'), Redditor(name='krat0s77'), Redditor(name='Winter-Werewolf8366'), Redditor(name='Dimakhaerus'), Redditor(name='Medium_Signal_761'), Redditor(name='thisishoustonover'), Redditor(name='Sea_Tonight566'), Redditor(name='diegocamp'), Redditor(name='Embarrassed-Fly6164'), Redditor(name='stratoskater_86'), Redditor(name='PeaceMajor3626'), Redditor(name='Salt_Brilliant_5010'), Redditor(name='HuesoNet'), Redditor(name='ILCaponchi'), Redditor(name='SulakeID'), Redditor(name='infiernoARG'), Redditor(name='Lutyiit'), Redditor(name='Resident_Nose_2467'), Redditor(name='GiggyWheat5'), Redditor(name='Salguih'), Redditor(name='Zantetsuken10'), Redditor(name='CartographerCool'), Redditor(name='Zealousideal-Tie8033'), Redditor(name='webo420'), Redditor(name='old_kitten'), Redditor(name='BatDynamite'), Redditor(name='Bicarbonatoo'), Redditor(name='uri_nrv'), Redditor(name='TheonlyJuan2024'), Redditor(name='Arlcas'), Redditor(name='IncogNeatoCompleto'), Redditor(name='UnExpertoEnLaMateria'), Redditor(name='videla98'), Redditor(name='yomatungo'), Redditor(name='Bombadil_Adept'), Redditor(name='derkonigistnackt'), Redditor(name='bamadeo'), Redditor(name='neutral24'), Redditor(name='Choriciento'), Redditor(name='metricwoodenruler'), Redditor(name='Barrilete_Cosmico'), Redditor(name='Old-Chair-420'), Redditor(name='nenfis'), Redditor(name='carpinchocolate'), Redditor(name='Equivalent-Quality84'), Redditor(name='Facilero'), Redditor(name='Infinite_Ad6387'), Redditor(name='VRichardsen'), Redditor(name='Gabriel-yo'), Redditor(name='desdecuando1'), Redditor(name='coffeewithnutmeg'), Redditor(name='CartographerCool'), Redditor(name='ZiYu14'), Redditor(name='Noalasdrogas420'), Redditor(name='Resident_Nose_2467'), Redditor(name='ErgoMachina'), None, Redditor(name='Dissociative18'), Redditor(name='CruzandoElRubicon'), Redditor(name='_oxitono'), Redditor(name='Gandalior'), Redditor(name='Moltarrr'), Redditor(name='Reize_Squealer'), Redditor(name='desdecuando1'), Redditor(name='Jauretche'), Redditor(name='Jauretche'), Redditor(name='RequirementSavings23'), Redditor(name='PeggyRomanoff'), Redditor(name='VRichardsen'), Redditor(name='desdecuando1'), Redditor(name='Lemon_Girl'), Redditor(name='RequirementSavings23'), Redditor(name='Own_Aardvark8373'), Redditor(name='desdecuando1'), Redditor(name='Turkesther'), Redditor(name='bautim'), Redditor(name='Ok_Half7136'), Redditor(name='Tricky_Pianist1469'), Redditor(name='ZiYu14'), Redditor(name='RedPorongo'), Redditor(name='johnkp3r'), Redditor(name='Zantetsuken10'), Redditor(name='finabengalablancate'), Redditor(name='Bicarbonatoo'), Redditor(name='BatDynamite'), Redditor(name='33p857'), Redditor(name='asdafio'), Redditor(name='Resident_Nose_2467'), Redditor(name='TheonlyJuan2024'), Redditor(name='sin-N_ombre'), Redditor(name='Bombadil_Adept'), Redditor(name='Reize_Squealer'), Redditor(name='AstrosLocos'), Redditor(name='Mac_Tgh'), Redditor(name='bamadeo'), Redditor(name='Middle_Procedure_922'), Redditor(name='Barrilete_Cosmico'), Redditor(name='Old-Chair-420'), Redditor(name='VRichardsen'), Redditor(name='VRichardsen'), Redditor(name='FineNightTonight'), Redditor(name='xxbluedevilsxx'), Redditor(name='Embarrassed-Fly6164'), Redditor(name='ZiYu14'), Redditor(name='Coti98'), Redditor(name='nariz1234'), Redditor(name='WeekendAtFangorn'), Redditor(name='Dustellar'), Redditor(name='Calm-Country'), Redditor(name='Ornery-Cookie877'), Redditor(name='CruzandoElRubicon'), Redditor(name='CruzandoElRubicon'), Redditor(name='VRichardsen'), Redditor(name='VRichardsen'), Redditor(name='Zantetsuken10'), Redditor(name='Zantetsuken10'), Redditor(name='TheonlyJuan2024'), Redditor(name='Barrilete_Cosmico'), Redditor(name='krysis08'), Redditor(name='MrX_aka_Benceno'), Redditor(name='CruzandoElRubicon'), Redditor(name='VRichardsen'), Redditor(name='Zantetsuken10'), Redditor(name='Jauretche'), Redditor(name='TheonlyJuan2024'), Redditor(name='Jauretche')]}

# ds_add_temas(temas_dict_prueba)
# ds_add_coms(comm_dict_prueba)
